<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Lie Detector - مع صاحبك</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <style>
    body { background: #111; color: #fff; font-family: 'Cairo', sans-serif; text-align: center; padding: 30px; }
    input, button { padding: 10px; margin: 10px; font-size: 18px; border-radius: 10px; }
    .hidden { display: none; }
  </style>
</head>
<body>

  <h1>🎯 Lie Detector – مع صاحبك</h1>

  <div id="setup">
    <h3>ادخل اسم الروم</h3>
    <input type="text" id="roomCode" placeholder="كود الروم">
    <br>
    <button onclick="createRoom()">إنشاء روم</button>
    <button onclick="joinRoom()">انضمام لروم</button>
  </div>

  <div id="questionPanel" class="hidden">
    <h2>📨 اكتب سؤال</h2>
    <input type="text" id="question" placeholder="اكتب سؤال...">
    <br>
    <button onclick="sendQuestion(true)">ده حقيقي ✅</button>
    <button onclick="sendQuestion(false)">ده كذب ❌</button>
  </div>

  <div id="answerPanel" class="hidden">
    <h2>🤔 جاوب على السؤال</h2>
    <div id="showQuestion"></div>
    <button onclick="answer(true)">صدق</button>
    <button onclick="answer(false)">كذب</button>
  </div>

  <div id="resultPanel" class="hidden">
    <h2 id="resultText"></h2>
    <button onclick="resetGame()">سؤال جديد</button>
  </div>

  <script>
    // Firebase config هنا حط بيانات مشروعك:
   const firebaseConfig = {
  apiKey: "AIzaSyB0Aj452H6Gp1ociH4ufHrLiU6Uucb-ysM",
  authDomain: "who-is-the-spy-51308.firebaseapp.com",
  databaseURL: "https://who-is-the-spy-51308-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "who-is-the-spy-51308",
  storageBucket: "who-is-the-spy-51308.firebasestorage.app",
  messagingSenderId: "900253646275",
  appId: "1:900253646275:web:b9f7a3cbb1069a07d2d176",
  measurementId: "G-NWXDDDRPRH"
};

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let room = "";
    let isOwner = false;

    function createRoom() {
      room = document.getElementById("roomCode").value;
      if (!room) return alert("اكتب كود الروم");
      isOwner = true;
      db.ref("rooms/" + room).set({}); // create empty room
      document.getElementById("setup").classList.add("hidden");
      document.getElementById("questionPanel").classList.remove("hidden");
    }

    function joinRoom() {
      room = document.getElementById("roomCode").value;
      if (!room) return alert("اكتب كود الروم");
      isOwner = false;
      db.ref("rooms/" + room).on("value", snapshot => {
        const data = snapshot.val();
        if (data && data.question) {
          document.getElementById("setup").classList.add("hidden");
          document.getElementById("answerPanel").classList.remove("hidden");
          document.getElementById("showQuestion").innerText = data.question;
        }
      });
    }

    function sendQuestion(isTrue) {
      const question = document.getElementById("question").value;
      if (!question) return alert("اكتب سؤال");
      db.ref("rooms/" + room).set({
        question: question,
        answer: isTrue
      });
      alert("السؤال تبعت ✅");
    }

    function answer(userAnswer) {
      db.ref("rooms/" + room).once("value").then(snapshot => {
        const realAnswer = snapshot.val().answer;
        const resultText = document.getElementById("resultText");

        if (userAnswer === realAnswer) {
          resultText.innerText = "🎉 إجابة صحيحة!";
        } else {
          resultText.innerText = "❌ إجابة خاطئة!";
        }

        document.getElementById("answerPanel").classList.add("hidden");
        document.getElementById("resultPanel").classList.remove("hidden");
      });
    }

    function resetGame() {
      if (isOwner) {
        document.getElementById("question").value = "";
        document.getElementById("questionPanel").classList.remove("hidden");
      }
      document.getElementById("resultPanel").classList.add("hidden");
    }
  </script>
</body>
</html>
