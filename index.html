<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø±ÙØ¹ ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¥Ù„Ù‰ Ù„ÙŠÙ†Ùƒ</title>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.9.0/firebase-storage.js"></script>

    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 50px; background: #f4f4f4; }
        .container { background: white; padding: 20px; border-radius: 10px; box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1); width: 50%; margin: auto; }
        .drop-area { border: 2px dashed #28a745; padding: 20px; cursor: pointer; background: #e9f7ef; margin-bottom: 10px; }
        .drop-area:hover { background: #d4edda; }
        input[type="file"] { display: none; }
        input, button { margin: 10px; padding: 10px; width: 80%; border: 1px solid #ddd; border-radius: 5px; }
        button { background-color: #28a745; color: white; cursor: pointer; }
        button:hover { background-color: #218838; }
        .progress-container { width: 80%; margin: 10px auto; background: #ddd; border-radius: 5px; overflow: hidden; }
        .progress-bar { width: 0%; height: 10px; background: #28a745; transition: width 0.3s; }
        .link-container { margin-top: 20px; display: none; }
        .copy-btn, .share-btn { background: #007bff; padding: 5px 10px; border: none; color: white; cursor: pointer; margin-left: 10px; }
        .copy-btn:hover, .share-btn:hover { background: #0056b3; }
        .success-message { color: #28a745; font-weight: bold; display: none; }
        .video-preview { width: 100%; max-width: 400px; margin-top: 10px; display: none; border-radius: 10px; }
    </style>
</head>
<body>

    <div class="container">
        <h2>Ø±ÙØ¹ ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¥Ù„Ù‰ Ù„ÙŠÙ†Ùƒ</h2>

        <!-- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª -->
        <div class="drop-area" onclick="document.getElementById('videoInput').click();">
            Ø§Ø³Ø­Ø¨ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ø¶ØºØ· Ù„Ø§Ø®ØªÙŠØ§Ø±Ù‡
        </div>

        <input type="file" id="videoInput" accept="video/*">
        <input type="text" id="customName" placeholder="Ø§Ø®ØªÙŠØ§Ø± Ø§Ø³Ù… Ø§Ù„Ù„ÙŠÙ†Ùƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"><br>
        <button onclick="uploadVideo()">Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</button>

        <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… -->
        <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
        </div>

        <!-- Ø¹Ø±Ø¶ ÙˆÙ‚Øª Ø§Ù„Ø±ÙØ¹ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ -->
        <p id="uploadTime" style="color: gray;"></p>

        <!-- Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ø¹Ø¯ Ø§Ù„Ø±ÙØ¹ -->
        <video controls class="video-preview" id="videoPreview"></video>

        <!-- Ø¹Ø±Ø¶ Ø§Ù„Ù„ÙŠÙ†Ùƒ Ø¨Ø¹Ø¯ Ø§Ù„Ø±ÙØ¹ -->
        <div class="link-container" id="linkContainer">
            <p id="linkOutput"></p>
            <button class="copy-btn" onclick="copyLink()">Ù†Ø³Ø® Ø§Ù„Ù„ÙŠÙ†Ùƒ</button>
            <button class="share-btn" onclick="shareLink()">Ù…Ø´Ø§Ø±ÙƒØ©</button>
        </div>

        <!-- Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­ -->
        <p class="success-message" id="successMessage">âœ… ØªÙ… Ø§Ù„Ø±ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­!</p>
    </div>

    <script>
        // ğŸ”¥ Ø¨ÙŠØ§Ù†Ø§Øª Firebase (Ø­Ø· Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ Ù‡Ù†Ø§)
     // For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyB0Aj452H6Gp1ociH4ufHrLiU6Uucb-ysM",
  authDomain: "who-is-the-spy-51308.firebaseapp.com",
  databaseURL: "https://who-is-the-spy-51308-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "who-is-the-spy-51308",
  storageBucket: "who-is-the-spy-51308.firebasestorage.app",
  messagingSenderId: "900253646275",
  appId: "1:900253646275:web:b9f7a3cbb1069a07d2d176",
  measurementId: "G-NWXDDDRPRH"
};
        // ğŸ”¥ ØªÙ‡ÙŠØ¦Ø© Firebase
        firebase.initializeApp(firebaseConfig);
        const storage = firebase.storage();

        // Ø¯Ø¹Ù… Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª
        const dropArea = document.querySelector('.drop-area');
        dropArea.addEventListener('dragover', (e) => { e.preventDefault(); dropArea.style.background = "#d4edda"; });
        dropArea.addEventListener('dragleave', () => { dropArea.style.background = "#e9f7ef"; });
        dropArea.addEventListener('drop', (e) => {
            e.preventDefault();
            dropArea.style.background = "#e9f7ef";
            document.getElementById('videoInput').files = e.dataTransfer.files;
        });

        function uploadVideo() {
            const videoFile = document.getElementById('videoInput').files[0];
            const customName = document.getElementById('customName').value || videoFile.name.split('.')[0];

            if (!videoFile) {
                alert("âŒ Ø§Ø®ØªØ± ÙÙŠØ¯ÙŠÙˆ Ø£ÙˆÙ„Ù‹Ø§!");
                return;
            }

            const storageRef = storage.ref(`videos/${customName}`);
            const uploadTask = storageRef.put(videoFile);
            const startTime = Date.now();

            uploadTask.on('state_changed',
                snapshot => {
                    const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                    document.getElementById('progressBar').style.width = progress + "%";

                    // Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ
                    const elapsedTime = (Date.now() - startTime) / 1000;
                    const estimatedTime = (elapsedTime / (progress / 100)) - elapsedTime;
                    document.getElementById('uploadTime').innerText = `â³ Ù…ØªØ¨Ù‚ÙŠ ${Math.ceil(estimatedTime)} Ø«Ø§Ù†ÙŠØ©`;
                },
                error => {
                    console.error("âŒ Ø®Ø·Ø£:", error);
                    alert("âš ï¸ ÙØ´Ù„ Ø§Ù„Ø±ÙØ¹! ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase.");
                },
                () => {
                    uploadTask.snapshot.ref.getDownloadURL().then(downloadURL => {
                        document.getElementById('linkOutput').innerHTML = `<a href="${downloadURL}" target="_blank">${downloadURL}</a>`;
                        document.getElementById('linkContainer').style.display = "block";
                        document.getElementById('successMessage').style.display = "block";

                        // Ø¹Ø±Ø¶ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¨Ø¹Ø¯ Ø§Ù„Ø±ÙØ¹
                        const videoPreview = document.getElementById('videoPreview');
                        videoPreview.src = downloadURL;
                        videoPreview.style.display = "block";
                    });
                }
            );
        }

        function copyLink() {
            const link = document.getElementById('linkOutput').textContent;
            navigator.clipboard.writeText(link).then(() => {
                alert("âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù„ÙŠÙ†Ùƒ!");
            }).catch(err => {
                console.error("âŒ ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø®:", err);
            });
        }

        function shareLink() {
            const link = document.getElementById('linkOutput').textContent;
            navigator.share ? navigator.share({ title: "Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ", url: link }) : alert("ğŸš€ Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©!");
        }
    </script>

</body>
</html>

