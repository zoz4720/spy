<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZoQuiz - Create and Take Quizzes</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #5e72e4;
            --secondary: #3f37c9;
            --accent: #f72585;
            --accent-dark: #d91a6d;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --light-gray: #e9ecef;
            --success: #4cc9f0;
            --warning: #ffbe0b;
            --danger: #ef233c;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: var(--dark);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 30px;
            flex-shrink: 0;
        }
        
        .logo {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary);
            display: flex;
            align-items: center;
        }
        
        .logo span {
            color: var(--accent);
        }
        
        .logo i {
            margin-right: 10px;
            font-size: 1.8rem;
        }
        
        nav ul {
            display: flex;
            list-style: none;
        }
        
        nav ul li {
            margin-left: 20px;
            position: relative;
        }
        
        nav ul li a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: color 0.3s;
            display: flex;
            align-items: center;
        }
        
        nav ul li a i {
            margin-right: 5px;
        }
        
        nav ul li a:hover {
            color: var(--primary);
        }
        
        .badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--accent);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .auth-buttons {
            display: flex;
            align-items: center;
        }
        
        .auth-buttons button {
            padding: 8px 16px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }
        
        .auth-buttons button i {
            margin-right: 5px;
        }
        
        .login-btn {
            background: transparent;
            color: var(--primary);
            border: 1px solid var(--primary);
            margin-right: 10px;
        }
        
        .login-btn:hover {
            background: rgba(67, 97, 238, 0.1);
        }
        
        .register-btn {
            background: var(--primary);
            color: white;
        }
        
        .register-btn:hover {
            background: var(--primary-light);
        }
        
        .user-menu {
            display: flex;
            align-items: center;
            position: relative;
            cursor: pointer;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: 600;
            transition: transform 0.3s;
        }
        
        .user-menu:hover .user-avatar {
            transform: scale(1.1);
        }
        
        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 5px;
            box-shadow: var(--shadow);
            width: 200px;
            z-index: 10;
            display: none;
            overflow: hidden;
        }
        
        .user-menu:hover .user-dropdown {
            display: block;
        }
        
        .dropdown-item {
            padding: 10px 15px;
            display: flex;
            align-items: center;
            color: var(--dark);
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .dropdown-item i {
            margin-right: 10px;
            color: var(--gray);
        }
        
        .dropdown-item:hover {
            background: var(--light-gray);
            color: var(--primary);
        }
        
        .dropdown-item:hover i {
            color: var(--primary);
        }
        
        .dropdown-divider {
            height: 1px;
            background: var(--light-gray);
            margin: 5px 0;
        }
        
        /* Main Content Styles */
        main {
            flex-grow: 1;
        }
        
        .hero {
            text-align: center;
            padding: 50px 0;
            background: linear-gradient(135deg, rgba(67, 97, 238, 0.1) 0%, rgba(247, 37, 133, 0.1) 100%);
            border-radius: 10px;
            margin-bottom: 40px;
        }
        
        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: var(--primary);
        }
        
        .hero p {
            font-size: 1.2rem;
            color: var(--gray);
            max-width: 700px;
            margin: 0 auto 30px;
        }
        
        .cta-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        
        .cta-buttons button {
            padding: 12px 24px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }
        
        .cta-buttons button i {
            margin-right: 8px;
        }
        
        .primary-btn {
            background: var(--primary);
            color: white;
        }
        
        .primary-btn:hover {
            background: var(--primary-light);
            box-shadow: var(--shadow-hover);
        }
        
        .secondary-btn {
            background: white;
            color: var(--primary);
            border: 1px solid var(--primary);
        }
        
        .secondary-btn:hover {
            background: rgba(67, 97, 238, 0.1);
            box-shadow: var(--shadow-hover);
        }
        
        /* Quiz Cards */
        .section-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .section-title h2 {
            color: var(--primary);
        }
        
        .view-all {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
            display: flex;
            align-items: center;
        }
        
        .view-all i {
            margin-left: 5px;
        }
        
        .quiz-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin: 40px 0;
        }
        
        .quiz-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: transform 0.3s, box-shadow 0.3s;
            display: flex;
            flex-direction: column;
            height: 100%;
        }
        
        .quiz-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }
        
        .quiz-image {
            height: 160px;
            background: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            position: relative;
        }
        
        .quiz-category {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 3px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
        }
        
        .quiz-difficulty {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 3px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
        }
        
        .difficulty-easy {
            background: var(--success);
        }
        
        .difficulty-medium {
            background: var(--warning);
            color: var(--dark);
        }
        
        .difficulty-hard {
            background: var(--danger);
        }
        
        .quiz-content {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .quiz-title {
            font-size: 1.3rem;
            margin-bottom: 10px;
            color: var(--dark);
        }
        
        .quiz-description {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 15px;
            flex-grow: 1;
        }
        
        .quiz-meta {
            display: flex;
            justify-content: space-between;
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .quiz-stats {
            display: flex;
            align-items: center;
        }
        
        .quiz-stats span {
            margin-right: 15px;
            display: flex;
            align-items: center;
        }
        
        .quiz-stats i {
            margin-right: 5px;
        }
        
        .quiz-author {
            display: flex;
            align-items: center;
        }
        
        .author-avatar {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: var(--secondary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            margin-right: 8px;
        }
        
        .quiz-actions {
            display: flex;
            gap: 10px;
        }
        
        .quiz-actions button {
            flex-grow: 1;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .quiz-actions button i {
            margin-right: 5px;
        }
        
        .take-quiz-btn {
            background: var(--primary);
            color: white;
        }
        
        .take-quiz-btn:hover {
            background: var(--primary-light);
        }
        
        .live-quiz-btn {
            background: var(--accent);
            color: white;
        }
        
        .live-quiz-btn:hover {
            background: var(--accent-dark);
        }
        
        /* Quiz Categories */
        .category-tabs {
            display: flex;
            overflow-x: auto;
            margin-bottom: 20px;
            padding-bottom: 5px;
        }
        
        .category-tab {
            padding: 8px 16px;
            background: white;
            border-radius: 20px;
            margin-right: 10px;
            cursor: pointer;
            font-weight: 500;
            white-space: nowrap;
            transition: all 0.3s;
            border: 1px solid var(--light-gray);
        }
        
        .category-tab:hover {
            background: var(--light-gray);
        }
        
        .category-tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        /* Auth Modals */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            width: 100%;
            max-width: 400px;
            position: relative;
            animation: modalFadeIn 0.3s;
        }
        
        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            background: none;
            border: none;
            color: var(--gray);
            transition: color 0.3s;
        }
        
        .close-btn:hover {
            color: var(--dark);
        }
        
        .auth-form h2 {
            text-align: center;
            margin-bottom: 20px;
            color: var(--primary);
        }
        
        .auth-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--light-gray);
        }
        
        .auth-tab {
            padding: 10px 20px;
            cursor: pointer;
            font-weight: 500;
            color: var(--gray);
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .auth-tab.active {
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .form-group input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        .password-container {
            position: relative;
        }
        
        .toggle-password {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            color: var(--gray);
        }
        
        .submit-btn {
            width: 100%;
            padding: 12px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .submit-btn:hover {
            background: var(--primary-light);
        }
        
        .form-footer {
            text-align: center;
            margin-top: 20px;
            font-size: 0.9rem;
        }
        
        .form-footer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 500;
        }
        
        .social-login {
            margin-top: 20px;
        }
        
        .social-login p {
            text-align: center;
            color: var(--gray);
            margin-bottom: 15px;
            position: relative;
        }
        
        .social-login p::before,
        .social-login p::after {
            content: "";
            display: inline-block;
            width: 30%;
            height: 1px;
            background: var(--light-gray);
            position: absolute;
            top: 50%;
        }
        
        .social-login p::before {
            left: 0;
        }
        
        .social-login p::after {
            right: 0;
        }
        
        .social-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        
        .social-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .social-btn:hover {
            transform: translateY(-3px);
        }
        
        .google-btn {
            background: #DB4437;
        }
        
        .facebook-btn {
            background: #4267B2;
        }
        
        .twitter-btn {
            background: #1DA1F2;
        }
        
        /* Quiz Creator */
        .quiz-creator {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            max-width: 800px;
            margin: 0 auto;
        }
        
        .quiz-creator h2 {
            text-align: center;
            margin-bottom: 30px;
            color: var(--primary);
        }
        
        .form-section {
            margin-bottom: 30px;
        }
        
        .form-section h3 {
            margin-bottom: 15px;
            color: var(--secondary);
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
            display: flex;
            align-items: center;
        }
        
        .form-section h3 i {
            margin-right: 10px;
        }
        
        .quiz-settings {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .time-limit-container {
            display: flex;
            align-items: center;
        }
        
        .time-limit-container input {
            flex-grow: 1;
            margin-right: 10px;
        }
        
        .time-limit-container span {
            white-space: nowrap;
        }
        
        .question-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            position: relative;
        }
        
        .question-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .question-type {
            padding: 3px 8px;
            background: var(--light-gray);
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .question-points {
            display: flex;
            align-items: center;
        }
        
        .question-points input {
            width: 60px;
            margin-left: 10px;
            padding: 5px;
        }
        
        .add-question-btn, .add-option-btn, .remove-question-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            margin-right: 10px;
            margin-top: 10px;
            display: flex;
            align-items: center;
        }
        
        .add-question-btn, .add-option-btn {
            background: var(--success);
            color: white;
        }
        
        .add-question-btn:hover, .add-option-btn:hover {
            opacity: 0.9;
        }
        
        .remove-question-btn {
            background: var(--danger);
            color: white;
        }
        
        .remove-question-btn:hover {
            opacity: 0.9;
        }
        
        .option-item {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .option-item input[type="radio"],
        .option-item input[type="checkbox"] {
            margin-right: 10px;
        }
        
        .option-item input[type="text"] {
            flex-grow: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .remove-option-btn {
            margin-left: 10px;
            background: var(--danger);
            color: white;
            border: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .publish-btn {
            display: block;
            width: 100%;
            padding: 12px;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .publish-btn i {
            margin-right: 10px;
        }
        
        .publish-btn:hover {
            background: var(--accent-dark);
        }
        
        /* Quiz Player */
        .quiz-player {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            max-width: 800px;
            margin: 0 auto;
        }
        
        .quiz-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .quiz-title {
            font-size: 1.5rem;
            color: var(--primary);
        }
        
        .quiz-meta {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        .timer-container {
            display: flex;
            align-items: center;
            background: var(--light-gray);
            padding: 5px 10px;
            border-radius: 20px;
        }
        
        .timer-container i {
            margin-right: 5px;
            color: var(--primary);
        }
        
        .question-container {
            margin-bottom: 30px;
        }
        
        .question-text {
            font-size: 1.2rem;
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .question-image {
            max-width: 100%;
            height: auto;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        
        .options-list {
            list-style: none;
        }
        
        .option-item {
            margin-bottom: 10px;
        }
        
        .option-label {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            background: #f8f9fa;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .option-label:hover {
            background: #e9ecef;
        }
        
        .option-input {
            margin-right: 10px;
        }
        
        .quiz-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        .quiz-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
        }
        
        .quiz-btn i {
            margin-right: 5px;
        }
        
        .prev-btn {
            background: #f8f9fa;
            color: var(--dark);
        }
        
        .prev-btn:hover {
            background: #e9ecef;
        }
        
        .next-btn {
            background: var(--primary);
            color: white;
        }
        
        .next-btn:hover {
            background: var(--primary-light);
        }
        
        .submit-quiz-btn {
            background: var(--accent);
            color: white;
        }
        
        .submit-quiz-btn:hover {
            background: var(--accent-dark);
        }
        
        /* Results Page */
        .results-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }
        
        .results-title {
            color: var(--primary);
            margin-bottom: 20px;
        }
        
        .results-icon {
            font-size: 4rem;
            color: var(--accent);
            margin-bottom: 20px;
        }
        
        .score-display {
            font-size: 3rem;
            color: var(--accent);
            margin: 20px 0;
        }
        
        .score-text {
            font-size: 1.2rem;
            margin-bottom: 30px;
        }
        
        .results-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            text-align: left;
        }
        
        .detail-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
        }
        
        .detail-card h3 {
            font-size: 0.9rem;
            color: var(--gray);
            margin-bottom: 5px;
        }
        
        .detail-card p {
            font-size: 1.1rem;
            font-weight: 500;
        }
        
        .results-breakdown {
            margin-top: 30px;
        }
        
        .results-breakdown h2 {
            text-align: left;
            margin-bottom: 15px;
            color: var(--primary);
        }
        
        .question-result {
            display: flex;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .question-result.correct {
            background: rgba(76, 201, 240, 0.1);
        }
        
        .question-result.incorrect {
            background: rgba(239, 35, 60, 0.1);
        }
        
        .result-icon {
            font-size: 1.5rem;
            margin-right: 15px;
        }
        
        .correct .result-icon {
            color: var(--success);
        }
        
        .incorrect .result-icon {
            color: var(--danger);
        }
        
        .question-result-content {
            flex-grow: 1;
        }
        
        .question-result-text {
            font-weight: 500;
            margin-bottom: 5px;
        }
        
        .question-result-answer {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .correct .question-result-answer {
            color: var(--success);
        }
        
        .incorrect .question-result-answer {
            color: var(--danger);
        }
        
        .results-actions {
            margin-top: 30px;
            display: flex;
            justify-content: center;
            gap: 15px;
        }
        
        .action-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
        }
        
        .action-btn i {
            margin-right: 8px;
        }
        
        .retake-btn {
            background: var(--primary);
            color: white;
        }
        
        .retake-btn:hover {
            background: var(--primary-light);
        }
        
        .new-quiz-btn {
            background: white;
            color: var(--primary);
            border: 1px solid var(--primary);
        }
        
        .new-quiz-btn:hover {
            background: rgba(67, 97, 238, 0.1);
        }
        
        .share-btn {
            background: var(--accent);
            color: white;
        }
        
        .share-btn:hover {
            background: var(--accent-dark);
        }
        
        /* Live Dashboard */
        .dashboard {
            display: grid;
            grid-template-columns: 250px 1fr;
            gap: 20px;
        }
        
        .sidebar {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 20px;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }
        
        .main-content {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--shadow);
        }
        
        .live-quiz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .live-quiz-title {
            font-size: 1.5rem;
            color: var(--primary);
        }
        
        .live-quiz-code {
            background: var(--light-gray);
            padding: 5px 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 1.2rem;
        }
        
        .participant-list {
            list-style: none;
        }
        
        .participant-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .participant-info {
            display: flex;
            align-items: center;
        }
        
        .participant-avatar {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            margin-right: 10px;
        }
        
        .participant-status {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--success);
        }
        
        .participant-status.offline {
            background: var(--gray);
        }
        
        .leaderboard {
            margin-top: 30px;
        }
        
        .leaderboard-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .leaderboard-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            margin-bottom: 5px;
            border-radius: 5px;
        }
        
        .leaderboard-position {
            font-weight: 600;
            margin-right: 10px;
        }
        
        .leaderboard-user {
            flex-grow: 1;
            display: flex;
            align-items: center;
        }
        
        .leaderboard-score {
            font-weight: 600;
            color: var(--primary);
        }
        
        .quiz-control-panel {
            margin-bottom: 30px;
        }
        
        .control-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .control-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
        }
        
        .control-btn i {
            margin-right: 5px;
        }
        
        .start-btn {
            background: var(--success);
            color: white;
        }
        
        .next-btn {
            background: var(--primary);
            color: white;
        }
        
        .end-btn {
            background: var(--danger);
            color: white;
        }
        
        .current-question {
            background: white;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .question-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--primary);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        .answer-distribution {
            margin-top: 30px;
        }
        
        .distribution-bar {
            height: 10px;
            background: var(--light-gray);
            border-radius: 5px;
            margin-bottom: 5px;
            overflow: hidden;
        }
        
        .distribution-fill {
            height: 100%;
            background: var(--primary);
        }
        
        .distribution-option {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: static;
                max-height: none;
            }
            
            .quiz-grid {
                grid-template-columns: 1fr;
            }
            
            header {
                flex-direction: column;
                text-align: center;
            }
            
            nav ul {
                margin-top: 20px;
                justify-content: center;
            }
            
            .auth-buttons {
                margin-top: 20px;
            }
            
            .quiz-settings {
                grid-template-columns: 1fr;
            }
            
            .results-details {
                grid-template-columns: 1fr;
            }
            
            .results-actions {
                flex-direction: column;
                gap: 10px;
            }
            
            .action-btn {
                width: 100%;
                justify-content: center;
            }
        }
        
        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        
        /* Utility Classes */
        .hidden {
            display: none;
        }
        
        .text-center {
            text-align: center;
        }
        
        .text-muted {
            color: var(--gray);
        }
        
        .mt-20 {
            margin-top: 20px;
        }
        
        .mb-20 {
            margin-bottom: 20px;
        }
        
        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-question-circle"></i>
                Zo<span>Quiz</span>
            </div>
            <nav>
                <ul>
                    <li><a href="#"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="#"><i class="fas fa-compass"></i> Explore</a></li>
                    <li><a href="#"><i class="fas fa-clipboard-list"></i> My Quizzes</a></li>
                    <li><a href="#"><i class="fas fa-plus-circle"></i> Create</a></li>
                    <li>
                        <a href="#"><i class="fas fa-bell"></i> Notifications</a>
                        <span class="badge">3</span>
                    </li>
                </ul>
            </nav>
            <div class="auth-buttons" id="authButtons">
                <button class="login-btn" id="loginBtn">
                    <i class="fas fa-sign-in-alt"></i> Log In
                </button>
                <button class="register-btn" id="registerBtn">
                    <i class="fas fa-user-plus"></i> Sign Up
                </button>
            </div>
            <div class="user-menu hidden" id="userMenu">
                <div class="user-avatar" id="userAvatar">U</div>
                <span id="username">User</span>
                <div class="user-dropdown">
                    <a href="#" class="dropdown-item">
                        <i class="fas fa-user"></i> Profile
                    </a>
                    <a href="#" class="dropdown-item">
                        <i class="fas fa-clipboard-list"></i> My Quizzes
                    </a>
                    <a href="#" class="dropdown-item">
                        <i class="fas fa-trophy"></i> Achievements
                    </a>
                    <div class="dropdown-divider"></div>
                    <a href="#" class="dropdown-item" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i> Log Out
                    </a>
                </div>
            </div>
        </header>

        <main>
            <!-- Home Page Content -->
            <section id="homePage">
                <div class="hero">
                    <h1>Create, Share, and Take Quizzes</h1>
                    <p>ZoQuiz is the platform where anyone can create quizzes and challenge others. Perfect for teachers, students, and trivia lovers!</p>
                    <div class="cta-buttons">
                        <button class="primary-btn" id="createQuizBtn">
                            <i class="fas fa-plus"></i> Create a Quiz
                        </button>
                        <button class="secondary-btn" id="exploreBtn">
                            <i class="fas fa-compass"></i> Explore Quizzes
                        </button>
                    </div>
                </div>

                <div class="section-title">
                    <h2><i class="fas fa-fire"></i> Popular Quizzes</h2>
                    <a href="#" class="view-all">View All <i class="fas fa-chevron-right"></i></a>
                </div>

                <div class="category-tabs">
                    <div class="category-tab active">All</div>
                    <div class="category-tab">Science</div>
                    <div class="category-tab">History</div>
                    <div class="category-tab">Geography</div>
                    <div class="category-tab">Movies</div>
                    <div class="category-tab">Music</div>
                    <div class="category-tab">Sports</div>
                    <div class="category-tab">Technology</div>
                </div>

                <div class="quiz-grid" id="quizGrid">
                    <!-- Quizzes will be loaded here -->
                    <div class="quiz-card">
                        <div class="quiz-image">
                            <span>S</span>
                            <span class="quiz-category">Science</span>
                            <span class="quiz-difficulty difficulty-medium">Medium</span>
                        </div>
                        <div class="quiz-content">
                            <h3 class="quiz-title">Science Trivia Challenge</h3>
                            <p class="quiz-description">Test your knowledge of basic science concepts with this fun quiz!</p>
                            <div class="quiz-meta">
                                <div class="quiz-stats">
                                    <span><i class="fas fa-question"></i> 10</span>
                                    <span><i class="fas fa-users"></i> 245</span>
                                    <span><i class="fas fa-star"></i> 4.8</span>
                                </div>
                                <div class="quiz-author">
                                    <div class="author-avatar">S</div>
                                    <span>ScienceGuy</span>
                                </div>
                            </div>
                            <div class="quiz-actions">
                                <button class="take-quiz-btn">
                                    <i class="fas fa-play"></i> Take Quiz
                                </button>
                                <button class="live-quiz-btn">
                                    <i class="fas fa-bolt"></i> Live
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="quiz-card">
                        <div class="quiz-image">
                            <span>W</span>
                            <span class="quiz-category">Geography</span>
                            <span class="quiz-difficulty difficulty-easy">Easy</span>
                        </div>
                        <div class="quiz-content">
                            <h3 class="quiz-title">World Capitals</h3>
                            <p class="quiz-description">How well do you know the capitals of the world? Take this quiz to find out!</p>
                            <div class="quiz-meta">
                                <div class="quiz-stats">
                                    <span><i class="fas fa-question"></i> 15</span>
                                    <span><i class="fas fa-users"></i> 189</span>
                                    <span><i class="fas fa-star"></i> 4.5</span>
                                </div>
                                <div class="quiz-author">
                                    <div class="author-avatar">T</div>
                                    <span>Traveler</span>
                                </div>
                            </div>
                            <div class="quiz-actions">
                                <button class="take-quiz-btn">
                                    <i class="fas fa-play"></i> Take Quiz
                                </button>
                                <button class="live-quiz-btn">
                                    <i class="fas fa-bolt"></i> Live
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="quiz-card">
                        <div class="quiz-image">
                            <span>M</span>
                            <span class="quiz-category">Movies</span>
                            <span class="quiz-difficulty difficulty-hard">Hard</span>
                        </div>
                        <div class="quiz-content">
                            <h3 class="quiz-title">Movie Quotes Challenge</h3>
                            <p class="quiz-description">Can you identify these famous movie quotes? Only true movie buffs will ace this!</p>
                            <div class="quiz-meta">
                                <div class="quiz-stats">
                                    <span><i class="fas fa-question"></i> 20</span>
                                    <span><i class="fas fa-users"></i> 312</span>
                                    <span><i class="fas fa-star"></i> 4.9</span>
                                </div>
                                <div class="quiz-author">
                                    <div class="author-avatar">C</div>
                                    <span>Cinephile</span>
                                </div>
                            </div>
                            <div class="quiz-actions">
                                <button class="take-quiz-btn">
                                    <i class="fas fa-play"></i> Take Quiz
                                </button>
                                <button class="live-quiz-btn">
                                    <i class="fas fa-bolt"></i> Live
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section-title">
                    <h2><i class="fas fa-chart-line"></i> Trending Now</h2>
                    <a href="#" class="view-all">View All <i class="fas fa-chevron-right"></i></a>
                </div>

                <div class="quiz-grid">
                    <!-- More quizzes can be added here -->
                </div>
            </section>

            <!-- Quiz Creator (hidden by default) -->
            <section id="quizCreator" class="hidden">
                <div class="quiz-creator">
                    <h2><i class="fas fa-plus-circle"></i> Create Your Quiz</h2>
                    
                    <div class="form-section">
                        <h3><i class="fas fa-info-circle"></i> Quiz Information</h3>
                        <div class="quiz-settings">
                            <div class="form-group">
                                <label for="quizTitle">Quiz Title</label>
                                <input type="text" id="quizTitle" placeholder="Enter quiz title">
                            </div>
                            <div class="form-group">
                                <label for="quizCategory">Category</label>
                                <select id="quizCategory" class="form-control">
                                    <option value="">Select a category</option>
                                    <option value="Science">Science</option>
                                    <option value="History">History</option>
                                    <option value="Geography">Geography</option>
                                    <option value="Movies">Movies</option>
                                    <option value="Music">Music</option>
                                    <option value="Sports">Sports</option>
                                    <option value="Technology">Technology</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="quizDescription">Description</label>
                            <textarea id="quizDescription" placeholder="Enter a short description" rows="3" class="form-control"></textarea>
                        </div>
                        <div class="quiz-settings">
                            <div class="form-group">
                                <label>Quiz Visibility</label>
                                <div>
                                    <input type="radio" id="visibilityPublic" name="visibility" value="public" checked>
                                    <label for="visibilityPublic">Public</label>
                                    <input type="radio" id="visibilityPrivate" name="visibility" value="private">
                                    <label for="visibilityPrivate">Private</label>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="timeLimit">Time Limit (minutes)</label>
                                <div class="time-limit-container">
                                    <input type="number" id="timeLimit" min="1" max="120" value="10">
                                    <span>minutes</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h3><i class="fas fa-question-circle"></i> Questions</h3>
                        <div id="questionsContainer">
                            <!-- Questions will be added here -->
                        </div>
                        <button class="add-question-btn" id="addQuestionBtn">
                            <i class="fas fa-plus"></i> Add Question
                        </button>
                    </div>
                    
                    <button class="publish-btn" id="publishBtn">
                        <i class="fas fa-upload"></i> Publish Quiz
                    </button>
                </div>
            </section>

            <!-- Quiz Player (hidden by default) -->
            <section id="quizPlayer" class="hidden">
                <div class="quiz-player">
                    <div class="quiz-header">
                        <div>
                            <h1 class="quiz-title" id="playerQuizTitle">Quiz Title</h1>
                            <div class="quiz-meta" id="playerQuizMeta">By User  10 questions</div>
                        </div>
                        <div class="timer-container" id="quizTimer">
                            <i class="fas fa-clock"></i>
                            <span>10:00</span>
                        </div>
                    </div>
                    
                    <div class="question-container">
                        <img src="https://via.placeholder.com/600x300" alt="Question Image" class="question-image" id="questionImage">
                        <div class="question-text" id="questionText">What is the capital of France?</div>
                        <ul class="options-list" id="optionsList">
                            <!-- Options will be added here -->
                        </ul>
                    </div>
                    
                    <div class="quiz-controls">
                        <button class="quiz-btn prev-btn" id="prevQuestionBtn" disabled>
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <div>
                            <span id="currentQuestion">1</span> of <span id="totalQuestions">10</span>
                        </div>
                        <button class="quiz-btn next-btn" id="nextQuestionBtn">
                            Next <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Results Page (hidden by default) -->
            <section id="resultsPage" class="hidden">
                <div class="results-container">
                    <div class="results-icon">
                        <i class="fas fa-trophy"></i>
                    </div>
                    <h1 class="results-title">Quiz Completed!</h1>
                    <div class="score-display" id="finalScore">8/10</div>
                    <p class="score-text" id="scoreText">Great job! You know your stuff!</p>
                    
                    <div class="results-details">
                        <div class="detail-card">
                            <h3>Correct Answers</h3>
                            <p id="correctAnswers">8</p>
                        </div>
                        <div class="detail-card">
                            <h3>Incorrect Answers</h3>
                            <p id="incorrectAnswers">2</p>
                        </div>
                        <div class="detail-card">
                            <h3>Score Percentage</h3>
                            <p id="scorePercentage">80%</p>
                        </div>
                        <div class="detail-card">
                            <h3>Time Taken</h3>
                            <p id="timeTaken">5:23</p>
                        </div>
                    </div>
                    
                    <div class="results-breakdown">
                        <h2>Question Breakdown</h2>
                        <div id="questionBreakdown">
                            <!-- Question results will be added here -->
                            <div class="question-result correct">
                                <div class="result-icon">
                                    <i class="fas fa-check-circle"></i>
                                </div>
                                <div class="question-result-content">
                                    <div class="question-result-text">What is the capital of France?</div>
                                    <div class="question-result-answer">Correct: Paris</div>
                                </div>
                            </div>
                            <div class="question-result incorrect">
                                <div class="result-icon">
                                    <i class="fas fa-times-circle"></i>
                                </div>
                                <div class="question-result-content">
                                    <div class="question-result-text">Which planet is closest to the sun?</div>
                                    <div class="question-result-answer">Your answer: Earth | Correct: Mercury</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="results-actions">
                        <button class="action-btn retake-btn" id="retakeBtn">
                            <i class="fas fa-redo"></i> Retake Quiz
                        </button>
                        <button class="action-btn new-quiz-btn" id="newQuizBtn">
                            <i class="fas fa-search"></i> Find Another Quiz
                        </button>
                        <button class="action-btn share-btn" id="shareBtn">
                            <i class="fas fa-share-alt"></i> Share Results
                        </button>
                    </div>
                </div>
            </section>

            <!-- Live Dashboard (hidden by default) -->
            <section id="liveDashboard" class="hidden">
                <div class="dashboard">
                    <div class="sidebar">
                        <div class="live-quiz-header">
                            <h3 class="live-quiz-title">Live Quiz</h3>
                            <div class="live-quiz-code">ZQ-5A9B</div>
                        </div>
                        
                        <h3><i class="fas fa-users"></i> Participants (5)</h3>
                        <ul class="participant-list" id="participantList">
                            <li class="participant-item">
                                <div class="participant-info">
                                    <div class="participant-avatar">J</div>
                                    <span>JohnDoe</span>
                                </div>
                                <div class="participant-status"></div>
                            </li>
                            <li class="participant-item">
                                <div class="participant-info">
                                    <div class="participant-avatar">S</div>
                                    <span>SarahSmith</span>
                                </div>
                                <div class="participant-status"></div>
                            </li>
                            <li class="participant-item">
                                <div class="participant-info">
                                    <div class="participant-avatar">M</div>
                                    <span>MikeJohnson</span>
                                </div>
                                <div class="participant-status offline"></div>
                            </li>
                        </ul>
                        
                        <div class="leaderboard">
                            <div class="leaderboard-title">
                                <h3><i class="fas fa-trophy"></i> Leaderboard</h3>
                            </div>
                            <div id="leaderboard">
                                <div class="leaderboard-item">
                                    <div class="leaderboard-position">1</div>
                                    <div class="leaderboard-user">
                                        <div class="participant-avatar">J</div>
                                        <span>JohnDoe</span>
                                    </div>
                                    <div class="leaderboard-score">850</div>
                                </div>
                                <div class="leaderboard-item">
                                    <div class="leaderboard-position">2</div>
                                    <div class="leaderboard-user">
                                        <div class="participant-avatar">S</div>
                                        <span>SarahSmith</span>
                                    </div>
                                    <div class="leaderboard-score">720</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="main-content">
                        <div class="live-quiz-header">
                            <h2 class="live-quiz-title">Science Trivia Challenge</h2>
                            <div class="timer-container">
                                <i class="fas fa-clock"></i>
                                <span>00:15</span>
                            </div>
                        </div>
                        
                        <div class="quiz-control-panel">
                            <div class="control-buttons">
                                <button class="control-btn start-btn">
                                    <i class="fas fa-play"></i> Start Quiz
                                </button>
                                <button class="control-btn next-btn" disabled>
                                    <i class="fas fa-forward"></i> Next Question
                                </button>
                                <button class="control-btn end-btn">
                                    <i class="fas fa-stop"></i> End Quiz
                                </button>
                            </div>
                        </div>
                        
                        <div class="current-question">
                            <h3>Current Question</h3>
                            <div id="currentQuestionDisplay">
                                <p>What is the chemical symbol for gold?</p>
                            </div>
                            
                            <div class="question-stats">
                                <div class="stat-card">
                                    <div class="stat-value">5</div>
                                    <div class="stat-label">Participants</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value">3</div>
                                    <div class="stat-label">Answered</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value">60%</div>
                                    <div class="stat-label">Correct</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value">12s</div>
                                    <div class="stat-label">Avg Time</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="answer-distribution">
                            <h3>Answer Distribution</h3>
                            <div class="distribution-option">
                                <span>A. Go</span>
                                <span>0% (0)</span>
                            </div>
                            <div class="distribution-bar">
                                <div class="distribution-fill" style="width: 0%"></div>
                            </div>
                            
                            <div class="distribution-option">
                                <span>B. Gd</span>
                                <span>20% (1)</span>
                            </div>
                            <div class="distribution-bar">
                                <div class="distribution-fill" style="width: 20%"></div>
                            </div>
                            
                            <div class="distribution-option">
                                <span>C. Au</span>
                                <span>60% (3)</span>
                            </div>
                            <div class="distribution-bar">
                                <div class="distribution-fill" style="width: 60%"></div>
                            </div>
                            
                            <div class="distribution-option">
                                <span>D. Ag</span>
                                <span>20% (1)</span>
                            </div>
                            <div class="distribution-bar">
                                <div class="distribution-fill" style="width: 20%"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Auth Modals -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <button class="close-btn" id="closeLoginModal">&times;</button>
            <div class="auth-form">
                <div class="auth-tabs">
                    <div class="auth-tab active">Login</div>
                    <div class="auth-tab" id="switchToRegister">Register</div>
                </div>
                
                <h2>Welcome Back!</h2>
                <div class="form-group">
                    <label for="loginEmail">Email</label>
                    <input type="email" id="loginEmail" placeholder="Enter your email">
                </div>
                <div class="form-group password-container">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password">
                    <i class="fas fa-eye toggle-password" id="toggleLoginPassword"></i>
                </div>
                <div class="form-group text-center">
                    <a href="#" id="forgotPassword">Forgot password?</a>
                </div>
                <button class="submit-btn" id="loginSubmitBtn">
                    <span id="loginBtnText">Log In</span>
                    <div class="spinner hidden" id="loginSpinner"></div>
                </button>
                
                <div class="social-login">
                    <p>Or login with</p>
                    <div class="social-buttons">
                        <div class="social-btn google-btn">
                            <i class="fab fa-google"></i>
                        </div>
                        <div class="social-btn facebook-btn">
                            <i class="fab fa-facebook-f"></i>
                        </div>
                        <div class="social-btn twitter-btn">
                            <i class="fab fa-twitter"></i>
                        </div>
                    </div>
                </div>
                
                <div class="form-footer">
                    Don't have an account? <a href="#" id="showRegister">Sign up</a>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="registerModal">
        <div class="modal-content">
            <button class="close-btn" id="closeRegisterModal">&times;</button>
            <div class="auth-form">
                <div class="auth-tabs">
                    <div class="auth-tab" id="switchToLogin">Login</div>
                    <div class="auth-tab active">Register</div>
                </div>
                
                <h2>Create Your Account</h2>
                <div class="form-group">
                    <label for="registerUsername">Username</label>
                    <input type="text" id="registerUsername" placeholder="Choose a username">
                </div>
                <div class="form-group">
                    <label for="registerEmail">Email</label>
                    <input type="email" id="registerEmail" placeholder="Enter your email">
                </div>
                <div class="form-group password-container">
                    <label for="registerPassword">Password</label>
                    <input type="password" id="registerPassword" placeholder="Create a password">
                    <i class="fas fa-eye toggle-password" id="toggleRegisterPassword"></i>
                </div>
                <div class="form-group password-container">
                    <label for="registerConfirmPassword">Confirm Password</label>
                    <input type="password" id="registerConfirmPassword" placeholder="Confirm your password">
                    <i class="fas fa-eye toggle-password" id="toggleRegisterConfirmPassword"></i>
                </div>
                <div class="form-group">
                    <input type="checkbox" id="agreeTerms">
                    <label for="agreeTerms">I agree to the <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a></label>
                </div>
                <button class="submit-btn" id="registerSubmitBtn">
                    <span id="registerBtnText">Sign Up</span>
                    <div class="spinner hidden" id="registerSpinner"></div>
                </button>
                
                <div class="social-login">
                    <p>Or sign up with</p>
                    <div class="social-buttons">
                        <div class="social-btn google-btn">
                            <i class="fab fa-google"></i>
                        </div>
                        <div class="social-btn facebook-btn">
                            <i class="fab fa-facebook-f"></i>
                        </div>
                        <div class="social-btn twitter-btn">
                            <i class="fab fa-twitter"></i>
                        </div>
                    </div>
                </div>
                
                <div class="form-footer">
                    Already have an account? <a href="#" id="showLogin">Log in</a>
                </div>
            </div>
        </div>
    </div>

    <script>
 const firebaseConfig = {
            apiKey: "AIzaSyB0Aj452H6Gp1ociH4ufHrLiU6Uucb-ysM",
            authDomain: "who-is-the-spy-51308.firebaseapp.com",
            databaseURL: "https://who-is-the-spy-51308-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "who-is-the-spy-51308",
            storageBucket: "who-is-the-spy-51308.appspot.com",
            messagingSenderId: "900253646275",
            appId: "1:900253646275:web:b9f7a3cbb1069a07d2d176",
            measurementId: "G-NWXDDDRPRH"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();

        // DOM Elements
        const loginBtn = document.getElementById('loginBtn');
        const registerBtn = document.getElementById('registerBtn');
        const authButtons = document.getElementById('authButtons');
        const userMenu = document.getElementById('userMenu');
        const userAvatar = document.getElementById('userAvatar');
        const username = document.getElementById('username');
        const logoutBtn = document.getElementById('logoutBtn');
        
        const loginModal = document.getElementById('loginModal');
        const registerModal = document.getElementById('registerModal');
        const closeLoginModal = document.getElementById('closeLoginModal');
        const closeRegisterModal = document.getElementById('closeRegisterModal');
        const showRegister = document.getElementById('showRegister');
        const showLogin = document.getElementById('showLogin');
        const switchToRegister = document.getElementById('switchToRegister');
        const switchToLogin = document.getElementById('switchToLogin');
        
        const loginSubmitBtn = document.getElementById('loginSubmitBtn');
        const registerSubmitBtn = document.getElementById('registerSubmitBtn');
        const loginBtnText = document.getElementById('loginBtnText');
        const registerBtnText = document.getElementById('registerBtnText');
        const loginSpinner = document.getElementById('loginSpinner');
        const registerSpinner = document.getElementById('registerSpinner');
        const forgotPassword = document.getElementById('forgotPassword');
        
        const toggleLoginPassword = document.getElementById('toggleLoginPassword');
        const toggleRegisterPassword = document.getElementById('toggleRegisterPassword');
        const toggleRegisterConfirmPassword = document.getElementById('toggleRegisterConfirmPassword');
        
        const homePage = document.getElementById('homePage');
        const quizCreator = document.getElementById('quizCreator');
        const quizPlayer = document.getElementById('quizPlayer');
        const resultsPage = document.getElementById('resultsPage');
        const liveDashboard = document.getElementById('liveDashboard');
        
        const createQuizBtn = document.getElementById('createQuizBtn');
        const exploreBtn = document.getElementById('exploreBtn');
        const quizGrid = document.getElementById('quizGrid');
        
        // Quiz Creator Elements
        const questionsContainer = document.getElementById('questionsContainer');
        const addQuestionBtn = document.getElementById('addQuestionBtn');
        const publishBtn = document.getElementById('publishBtn');
        const quizTitle = document.getElementById('quizTitle');
        const quizDescription = document.getElementById('quizDescription');
        const quizCategory = document.getElementById('quizCategory');
        const timeLimit = document.getElementById('timeLimit');
        
        // Quiz Player Elements
        const playerQuizTitle = document.getElementById('playerQuizTitle');
        const playerQuizMeta = document.getElementById('playerQuizMeta');
        const quizTimer = document.getElementById('quizTimer');
        const questionText = document.getElementById('questionText');
        const questionImage = document.getElementById('questionImage');
        const optionsList = document.getElementById('optionsList');
        const prevQuestionBtn = document.getElementById('prevQuestionBtn');
        const nextQuestionBtn = document.getElementById('nextQuestionBtn');
        const currentQuestion = document.getElementById('currentQuestion');
        const totalQuestions = document.getElementById('totalQuestions');
        
        // Results Page Elements
        const finalScore = document.getElementById('finalScore');
        const scoreText = document.getElementById('scoreText');
        const correctAnswers = document.getElementById('correctAnswers');
        const incorrectAnswers = document.getElementById('incorrectAnswers');
        const scorePercentage = document.getElementById('scorePercentage');
        const timeTaken = document.getElementById('timeTaken');
        const questionBreakdown = document.getElementById('questionBreakdown');
        const retakeBtn = document.getElementById('retakeBtn');
        const newQuizBtn = document.getElementById('newQuizBtn');
        const shareBtn = document.getElementById('shareBtn');
        
        // Live Dashboard Elements
        const participantList = document.getElementById('participantList');
        const leaderboard = document.getElementById('leaderboard');
        
        // App State
        let currentUser = null;
        let currentQuiz = null;
        let userQuizzes = [];
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let quizResults = {};
        let liveParticipants = [];
        let timerInterval;
        let timeLeft = 0;
        let quizStartTime = 0;

        // Initialize the app
        function init() {
            auth.onAuthStateChanged(user => {
                if (user) {
                    // User is signed in
                    currentUser = user;
                    authButtons.classList.add('hidden');
                    userMenu.classList.remove('hidden');
                    userAvatar.textContent = user.displayName ? user.displayName.charAt(0).toUpperCase() : user.email.charAt(0).toUpperCase();
                    username.textContent = user.displayName || user.email.split('@')[0];
                    
                    // Load user's quizzes
                    loadUserQuizzes();
                } else {
                    // User is signed out
                    currentUser = null;
                    authButtons.classList.remove('hidden');
                    userMenu.classList.add('hidden');
                }
            });
            
            // Load public quizzes
            loadQuizzes();
            
            // Set up event listeners
            setupEventListeners();
        }

        function setupEventListeners() {
            // Auth buttons
            loginBtn.addEventListener('click', () => {
                loginModal.style.display = 'flex';
                registerModal.style.display = 'none';
            });
            
            registerBtn.addEventListener('click', () => {
                registerModal.style.display = 'flex';
                loginModal.style.display = 'none';
            });
            
            // Modal close buttons
            closeLoginModal.addEventListener('click', () => loginModal.style.display = 'none');
            closeRegisterModal.addEventListener('click', () => registerModal.style.display = 'none');
            
            // Switch between login and register
            showRegister.addEventListener('click', () => {
                loginModal.style.display = 'none';
                registerModal.style.display = 'flex';
            });
            
            showLogin.addEventListener('click', () => {
                registerModal.style.display = 'none';
                loginModal.style.display = 'flex';
            });
            
            switchToRegister.addEventListener('click', () => {
                loginModal.style.display = 'none';
                registerModal.style.display = 'flex';
            });
            
            switchToLogin.addEventListener('click', () => {
                registerModal.style.display = 'none';
                loginModal.style.display = 'flex';
            });
            
            // Toggle password visibility
            toggleLoginPassword.addEventListener('click', function() {
                togglePasswordVisibility('loginPassword', this);
            });
            
            toggleRegisterPassword.addEventListener('click', function() {
                togglePasswordVisibility('registerPassword', this);
            });
            
            toggleRegisterConfirmPassword.addEventListener('click', function() {
                togglePasswordVisibility('registerConfirmPassword', this);
            });
            
            // Auth form submissions
            loginSubmitBtn.addEventListener('click', loginUser);
            registerSubmitBtn.addEventListener('click', registerUser);
            forgotPassword.addEventListener('click', resetPassword);
            logoutBtn.addEventListener('click', logoutUser);
            
            // Navigation
            createQuizBtn.addEventListener('click', showQuizCreator);
            exploreBtn.addEventListener('click', showHomePage);
            
            // Quiz creation
            addQuestionBtn.addEventListener('click', addQuestion);
            publishBtn.addEventListener('click', publishQuiz);
            
            // Quiz navigation
            prevQuestionBtn.addEventListener('click', goToPreviousQuestion);
            nextQuestionBtn.addEventListener('click', goToNextQuestion);
            
            // Results actions
            retakeBtn.addEventListener('click', retakeQuiz);
            newQuizBtn.addEventListener('click', showHomePage);
            shareBtn.addEventListener('click', shareResults);
        }

        function togglePasswordVisibility(inputId, icon) {
            const input = document.getElementById(inputId);
            if (input.type === 'password') {
                input.type = 'text';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            } else {
                input.type = 'password';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            }
        }

        // Auth Functions
        function loginUser() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                alert('Please fill in all fields');
                return;
            }
            
            // Show loading state
            loginBtnText.classList.add('hidden');
            loginSpinner.classList.remove('hidden');
            
            auth.signInWithEmailAndPassword(email, password)
                .then(() => {
                    loginModal.style.display = 'none';
                    clearAuthForms();
                })
                .catch(error => {
                    alert(error.message);
                })
                .finally(() => {
                    // Hide loading state
                    loginBtnText.classList.remove('hidden');
                    loginSpinner.classList.add('hidden');
                });
        }
        
        function registerUser() {
            const username = document.getElementById('registerUsername').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('registerConfirmPassword').value;
            const agreeTerms = document.getElementById('agreeTerms').checked;
            
            if (!username || !email || !password || !confirmPassword) {
                alert('Please fill in all fields');
                return;
            }
            
            if (!agreeTerms) {
                alert('You must agree to the Terms of Service and Privacy Policy');
                return;
            }
            
            if (password !== confirmPassword) {
                alert("Passwords don't match!");
                return;
            }
            
            // Show loading state
            registerBtnText.classList.add('hidden');
            registerSpinner.classList.remove('hidden');
            
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    // Update user profile with display name
                    return userCredential.user.updateProfile({
                        displayName: username
                    }).then(() => {
                        // Save additional user info to database
                        return db.ref('users/' + userCredential.user.uid).set({
                            username: username,
                            email: email,
                            createdAt: firebase.database.ServerValue.TIMESTAMP,
                            quizzesCreated: 0,
                            quizzesTaken: 0,
                            totalPoints: 0
                        });
                    });
                })
                .then(() => {
                    registerModal.style.display = 'none';
                    clearAuthForms();
                })
                .catch(error => {
                    alert(error.message);
                })
                .finally(() => {
                    // Hide loading state
                    registerBtnText.classList.remove('hidden');
                    registerSpinner.classList.add('hidden');
                });
        }
        
        function resetPassword() {
            const email = document.getElementById('loginEmail').value;
            
            if (!email) {
                alert('Please enter your email address');
                return;
            }
            
            auth.sendPasswordResetEmail(email)
                .then(() => {
                    alert('Password reset email sent. Please check your inbox.');
                    loginModal.style.display = 'none';
                })
                .catch(error => {
                    alert(error.message);
                });
        }
        
        function logoutUser() {
            auth.signOut()
                .then(() => {
                    showHomePage();
                })
                .catch(error => {
                    alert(error.message);
                });
        }
        
        function clearAuthForms() {
            document.getElementById('loginEmail').value = '';
            document.getElementById('loginPassword').value = '';
            document.getElementById('registerUsername').value = '';
            document.getElementById('registerEmail').value = '';
            document.getElementById('registerPassword').value = '';
            document.getElementById('registerConfirmPassword').value = '';
            document.getElementById('agreeTerms').checked = false;
        }

        // Quiz Functions
        function loadQuizzes() {
            // Show loading state
            quizGrid.innerHTML = '<div class="loading">Loading quizzes...</div>';
            
            db.ref('quizzes').orderByChild('isPublic').equalTo(true).once('value')
                .then(snapshot => {
                    quizGrid.innerHTML = '';
                    const quizzes = snapshot.val() || {};
                    
                    if (Object.keys(quizzes).length === 0) {
                        quizGrid.innerHTML = '<div class="no-quizzes">No quizzes available yet. Be the first to create one!</div>';
                        return;
                    }
                    
                    Object.keys(quizzes).forEach(quizId => {
                        const quiz = quizzes[quizId];
                        if (quiz.isPublic) {
                            createQuizCard(quizId, quiz);
                        }
                    });
                })
                .catch(error => {
                    console.error("Error loading quizzes:", error);
                    quizGrid.innerHTML = '<div class="error">Failed to load quizzes. Please try again later.</div>';
                });
        }
        
        function createQuizCard(quizId, quiz) {
            const quizCard = document.createElement('div');
            quizCard.className = 'quiz-card fade-in';
            quizCard.innerHTML = `
                <div class="quiz-image">${quiz.title.charAt(0)}</div>
                <div class="quiz-content">
                    <h3 class="quiz-title">${quiz.title}</h3>
                    <p class="quiz-description">${quiz.description || 'No description provided'}</p>
                    <div class="quiz-meta">
                        <div class="quiz-stats">
                            <span><i class="fas fa-question"></i> ${quiz.questions.length}</span>
                            <span><i class="fas fa-users"></i> ${quiz.participants ? Object.keys(quiz.participants).length : 0}</span>
                            <span><i class="fas fa-star"></i> ${quiz.rating ? quiz.rating.toFixed(1) : 'N/A'}</span>
                        </div>
                        <div class="quiz-author">
                            <div class="author-avatar">${quiz.creatorName.charAt(0)}</div>
                            <span>${quiz.creatorName}</span>
                        </div>
                    </div>
                    <div class="quiz-actions">
                        <button class="take-quiz-btn" data-id="${quizId}">
                            <i class="fas fa-play"></i> Take Quiz
                        </button>
                        ${currentUser && quiz.creatorId === currentUser.uid ? 
                          `<button class="live-quiz-btn" data-id="${quizId}">
                              <i class="fas fa-bolt"></i> Live
                          </button>` : ''}
                    </div>
                </div>
            `;
            quizGrid.appendChild(quizCard);
            
            // Add event listener to quiz button
            quizCard.querySelector('.take-quiz-btn').addEventListener('click', function() {
                startQuiz(quizId);
            });
            
            // Add event listener to live quiz button if present
            const liveBtn = quizCard.querySelector('.live-quiz-btn');
            if (liveBtn) {
                liveBtn.addEventListener('click', function() {
                    startLiveQuiz(quizId);
                });
            }
        }
        
        function loadUserQuizzes() {
            if (!currentUser) return;
            
            db.ref('quizzes').orderByChild('creatorId').equalTo(currentUser.uid).once('value')
                .then(snapshot => {
                    userQuizzes = snapshot.val() || {};
                })
                .catch(error => {
                    console.error("Error loading user quizzes:", error);
                });
        }
        
        function showQuizCreator() {
            if (!currentUser) {
                alert('Please log in to create a quiz');
                loginModal.style.display = 'flex';
                return;
            }
            
            homePage.classList.add('hidden');
            quizCreator.classList.remove('hidden');
            questionsContainer.innerHTML = '';
            addQuestion(); // Add first question by default
        }
        
        function addQuestion() {
            const questionId = 'question-' + Date.now();
            const questionDiv = document.createElement('div');
            questionDiv.className = 'question-item fade-in';
            questionDiv.innerHTML = `
                <div class="question-item-header">
                    <div class="question-type">Multiple Choice</div>
                    <div class="question-points">
                        Points: <input type="number" min="1" value="1" class="question-points-input">
                    </div>
                </div>
                <div class="form-group">
                    <label>Question ${questionsContainer.children.length + 1}</label>
                    <input type="text" class="question-input" placeholder="Enter your question" required>
                </div>
                <div class="form-group">
                    <label>Question Image (optional)</label>
                    <input type="text" class="question-image-input" placeholder="Enter image URL">
                </div>
                <div class="options-container" id="${questionId}-options">
                    <!-- Options will be added here -->
                </div>
                <button type="button" class="add-option-btn" data-question="${questionId}">
                    <i class="fas fa-plus"></i> Add Option
                </button>
                <button type="button" class="remove-question-btn" data-question="${questionId}">
                    <i class="fas fa-trash"></i> Remove Question
                </button>
            `;
            questionsContainer.appendChild(questionDiv);
            
            // Add event listeners
            const addOptionBtn = questionDiv.querySelector('.add-option-btn');
            const removeQuestionBtn = questionDiv.querySelector('.remove-question-btn');
            
            addOptionBtn.addEventListener('click', function() {
                addOption(this.getAttribute('data-question'));
            });
            
            removeQuestionBtn.addEventListener('click', function() {
                if (questionsContainer.children.length > 1) {
                    questionDiv.remove();
                    updateQuestionNumbers();
                } else {
                    alert('You need at least one question');
                }
            });
            
            // Add first two options by default
            addOption(questionId);
            addOption(questionId);
        }
        
        function addOption(questionId) {
            const optionsContainer = document.getElementById(`${questionId}-options`);
            const optionId = `option-${Date.now()}`;
            
            const optionDiv = document.createElement('div');
            optionDiv.className = 'option-item';
            optionDiv.innerHTML = `
                <input type="radio" name="${questionId}-correct" class="option-input" required>
                <input type="text" class="option-text" placeholder="Enter option text" required>
                <button type="button" class="remove-option-btn" data-option="${optionId}">
                    <i class="fas fa-times"></i>
                </button>
            `;
            optionsContainer.appendChild(optionDiv);
            
            // Add event listener to remove button
            const removeBtn = optionDiv.querySelector('.remove-option-btn');
            removeBtn.addEventListener('click', function() {
                if (optionsContainer.children.length > 2) {
                    optionDiv.remove();
                } else {
                    alert('You need at least two options');
                }
            });
        }
        
        function updateQuestionNumbers() {
            const questions = questionsContainer.querySelectorAll('.question-item');
            questions.forEach((question, index) => {
                question.querySelector('label').textContent = `Question ${index + 1}`;
            });
        }
        
        function publishQuiz() {
            if (!currentUser) {
                alert('Please log in to publish a quiz');
                return;
            }
            
            // Validate quiz title
            if (!quizTitle.value.trim()) {
                alert('Please enter a quiz title');
                quizTitle.focus();
                return;
            }
            
            // Validate at least one question
            const questions = questionsContainer.querySelectorAll('.question-item');
            if (questions.length === 0) {
                alert('Please add at least one question');
                return;
            }
            
            // Validate each question
            let isValid = true;
            const quizQuestions = [];
            
            questions.forEach((questionDiv, index) => {
                const questionInput = questionDiv.querySelector('.question-input');
                const questionImage = questionDiv.querySelector('.question-image-input');
                const options = questionDiv.querySelectorAll('.option-text');
                const correctOption = questionDiv.querySelector('.option-input:checked');
                const pointsInput = questionDiv.querySelector('.question-points-input');
                const points = parseInt(pointsInput.value) || 1;
                
                // Validate question text
                if (!questionInput.value.trim()) {
                    alert(`Please enter text for question ${index + 1}`);
                    questionInput.focus();
                    isValid = false;
                    return;
                }
                
                // Validate at least two options
                if (options.length < 2) {
                    alert(`Question ${index + 1} needs at least two options`);
                    isValid = false;
                    return;
                }
                
                // Validate all options have text
                options.forEach(option => {
                    if (!option.value.trim()) {
                        alert(`Please enter text for all options in question ${index + 1}`);
                        option.focus();
                        isValid = false;
                        return;
                    }
                });
                
                // Validate correct option selected
                if (!correctOption) {
                    alert(`Please select the correct answer for question ${index + 1}`);
                    isValid = false;
                    return;
                }
                
                if (!isValid) return;
                
                // Build question object
                const questionObj = {
                    question: questionInput.value.trim(),
                    options: Array.from(options).map(opt => opt.value.trim()),
                    answer: Array.from(questionDiv.querySelectorAll('.option-input'))
                        .indexOf(correctOption),
                    points: points,
                    image: questionImage.value.trim() || null
                };
                
                quizQuestions.push(questionObj);
            });
            
            if (!isValid) return;
            
            // Create quiz object
            const quiz = {
                title: quizTitle.value.trim(),
                description: quizDescription.value.trim(),
                category: quizCategory.value || 'General',
                questions: quizQuestions,
                creatorId: currentUser.uid,
                creatorName: currentUser.displayName || currentUser.email.split('@')[0],
                createdAt: firebase.database.ServerValue.TIMESTAMP,
                isPublic: document.getElementById('visibilityPublic').checked,
                timeLimit: parseInt(timeLimit.value) * 60 || null, // Convert to seconds
                participants: {},
                rating: null,
                ratingsCount: 0
            };
            
            // Show loading state
            publishBtn.innerHTML = '<div class="spinner"></div> Publishing...';
            
            // Save to database
            const newQuizRef = db.ref('quizzes').push();
            newQuizRef.set(quiz)
                .then(() => {
                    // Update user's quiz count
                    return db.ref(`users/${currentUser.uid}/quizzesCreated`).transaction(current => {
                        return (current || 0) + 1;
                    });
                })
                .then(() => {
                    alert('Quiz published successfully!');
                    resetQuizCreator();
                    showHomePage();
                    loadQuizzes();
                })
                .catch(error => {
                    console.error("Error publishing quiz:", error);
                    alert('Failed to publish quiz. Please try again.');
                })
                .finally(() => {
                    // Reset publish button
                    publishBtn.innerHTML = '<i class="fas fa-upload"></i> Publish Quiz';
                });
        }
        
        function resetQuizCreator() {
            quizTitle.value = '';
            quizDescription.value = '';
            quizCategory.value = '';
            timeLimit.value = '10';
            document.getElementById('visibilityPublic').checked = true;
            questionsContainer.innerHTML = '';
        }
        
        function startQuiz(quizId) {
            db.ref(`quizzes/${quizId}`).once('value')
                .then(snapshot => {
                    currentQuiz = {
                        id: quizId,
                        ...snapshot.val()
                    };
                    
                    // Initialize quiz state
                    currentQuestionIndex = 0;
                    userAnswers = new Array(currentQuiz.questions.length).fill(null);
                    timeLeft = currentQuiz.timeLimit || 0; // In seconds
                    quizStartTime = Date.now();
                    
                    // Show quiz player
                    showQuizPlayer();
                    
                    // Start timer if time limit exists
                    if (currentQuiz.timeLimit) {
                        startTimer();
                    }
                    
                    // Load first question
                    loadQuestion();
                })
                .catch(error => {
                    console.error("Error loading quiz:", error);
                    alert('Failed to load quiz. Please try again.');
                });
        }
        
        function showQuizPlayer() {
            homePage.classList.add('hidden');
            quizCreator.classList.add('hidden');
            resultsPage.classList.add('hidden');
            liveDashboard.classList.add('hidden');
            quizPlayer.classList.remove('hidden');
            
            playerQuizTitle.textContent = currentQuiz.title;
            playerQuizMeta.textContent = `By ${currentQuiz.creatorName}  ${currentQuiz.questions.length} questions`;
            totalQuestions.textContent = currentQuiz.questions.length;
            
            if (currentQuiz.timeLimit) {
                quizTimer.classList.remove('hidden');
                updateTimerDisplay();
            } else {
                quizTimer.classList.add('hidden');
            }
        }
        
        function startTimer() {
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    endQuiz();
                }
            }, 1000);
        }
        
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            quizTimer.querySelector('span').textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
        }
        
        function loadQuestion() {
            const question = currentQuiz.questions[currentQuestionIndex];
            
            questionText.textContent = question.question;
            optionsList.innerHTML = '';
            
            // Set question image if available
            if (question.image) {
                questionImage.src = question.image;
                questionImage.classList.remove('hidden');
            } else {
                questionImage.classList.add('hidden');
            }
            
            question.options.forEach((option, index) => {
                const li = document.createElement('li');
                li.className = 'option-item fade-in';
                li.innerHTML = `
                    <label class="option-label">
                        <input type="radio" name="quiz-option" class="option-input" value="${index}">
                        ${option}
                    </label>
                `;
                optionsList.appendChild(li);
                
                // Set checked if user already answered
                if (userAnswers[currentQuestionIndex] === index) {
                    li.querySelector('input').checked = true;
                }
            });
            
            // Update question counter
            currentQuestion.textContent = currentQuestionIndex + 1;
            
            // Update button states
            prevQuestionBtn.disabled = currentQuestionIndex === 0;
            
            if (currentQuestionIndex === currentQuiz.questions.length - 1) {
                nextQuestionBtn.textContent = 'Submit';
                nextQuestionBtn.classList.remove('next-btn');
                nextQuestionBtn.classList.add('submit-quiz-btn');
            } else {
                nextQuestionBtn.textContent = 'Next';
                nextQuestionBtn.classList.remove('submit-quiz-btn');
                nextQuestionBtn.classList.add('next-btn');
            }
        }
        
        function goToPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                saveAnswer();
                currentQuestionIndex--;
                loadQuestion();
            }
        }
        
        function goToNextQuestion() {
            saveAnswer();
            
            if (currentQuestionIndex < currentQuiz.questions.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            } else {
                endQuiz();
            }
        }
        
        function saveAnswer() {
            const selectedOption = document.querySelector('input[name="quiz-option"]:checked');
            if (selectedOption) {
                userAnswers[currentQuestionIndex] = parseInt(selectedOption.value);
            }
        }
        
        function endQuiz() {
            clearInterval(timerInterval);
            
            // Calculate score and points
            let score = 0;
            let totalPoints = 0;
            let correctCount = 0;
            let incorrectCount = 0;
            
            currentQuiz.questions.forEach((question, index) => {
                if (userAnswers[index] === question.answer) {
                    score++;
                    correctCount++;
                    totalPoints += question.points || 1;
                } else {
                    incorrectCount++;
                }
            });
            
            // Calculate time taken
            const timeTakenMs = Date.now() - quizStartTime;
            const minutesTaken = Math.floor(timeTakenMs / 60000);
            const secondsTaken = Math.floor((timeTakenMs % 60000) / 1000);
            
            // Save results
            quizResults = {
                score: score,
                total: currentQuiz.questions.length,
                points: totalPoints,
                correctAnswers: correctCount,
                incorrectAnswers: incorrectCount,
                percentage: Math.round((score / currentQuiz.questions.length) * 100),
                timeTaken: `${minutesTaken}:${secondsTaken < 10 ? '0' : ''}${secondsTaken}`,
                dateTaken: firebase.database.ServerValue.TIMESTAMP
            };
            
            // Save results to database if user is logged in
            if (currentUser) {
                // Save user's quiz result
                db.ref(`users/${currentUser.uid}/takenQuizzes/${currentQuiz.id}`).set(quizResults)
                    .then(() => {
                        // Update user's quiz count and total points
                        return db.ref(`users/${currentUser.uid}`).transaction(user => {
                            if (user) {
                                user.quizzesTaken = (user.quizzesTaken || 0) + 1;
                                user.totalPoints = (user.totalPoints || 0) + totalPoints;
                            }
                            return user;
                        });
                    })
                    .then(() => {
                        // Update quiz's participant count
                        return db.ref(`quizzes/${currentQuiz.id}/participants/${currentUser.uid}`).set({
                            score: score,
                            points: totalPoints,
                            dateTaken: firebase.database.ServerValue.TIMESTAMP
                        });
                    })
                    .catch(error => {
                        console.error("Error saving quiz results:", error);
                    });
            }
            
            // Show results
            showResults();
        }
        
        function showResults() {
            quizPlayer.classList.add('hidden');
            resultsPage.classList.remove('hidden');
            
            // Set main results
            finalScore.textContent = `${quizResults.score}/${quizResults.total}`;
            correctAnswers.textContent = quizResults.correctAnswers;
            incorrectAnswers.textContent = quizResults.incorrectAnswers;
            scorePercentage.textContent = `${quizResults.percentage}%`;
            timeTaken.textContent = quizResults.timeTaken;
            
            // Set score message
            let message = '';
            let icon = '';
            
            if (quizResults.percentage >= 80) {
                message = 'Excellent work! You really know your stuff!';
                icon = 'fas fa-trophy';
            } else if (quizResults.percentage >= 60) {
                message = 'Good job! You did well!';
                icon = 'fas fa-thumbs-up';
            } else if (quizResults.percentage >= 40) {
                message = 'Not bad! Keep practicing!';
                icon = 'fas fa-meh';
            } else {
                message = 'Keep trying! You can do better next time!';
                icon = 'fas fa-redo';
            }
            
            scoreText.textContent = message;
            document.querySelector('.results-icon i').className = icon;
            
            // Build question breakdown
            questionBreakdown.innerHTML = '';
            
            currentQuiz.questions.forEach((question, index) => {
                const isCorrect = userAnswers[index] === question.answer;
                const resultDiv = document.createElement('div');
                resultDiv.className = `question-result ${isCorrect ? 'correct' : 'incorrect'} fade-in`;
                
                let answerText = '';
                if (isCorrect) {
                    answerText = `Correct: ${question.options[question.answer]}`;
                } else {
                    const userAnswer = userAnswers[index] !== null ? 
                        `Your answer: ${question.options[userAnswers[index]]} | ` : '';
                    answerText = `${userAnswer}Correct: ${question.options[question.answer]}`;
                }
                
                resultDiv.innerHTML = `
                    <div class="result-icon">
                        <i class="fas fa-${isCorrect ? 'check' : 'times'}-circle"></i>
                    </div>
                    <div class="question-result-content">
                        <div class="question-result-text">${question.question}</div>
                        <div class="question-result-answer">${answerText}</div>
                    </div>
                `;
                
                questionBreakdown.appendChild(resultDiv);
            });
        }
        
        function retakeQuiz() {
            startQuiz(currentQuiz.id);
        }
        
        function showHomePage() {
            quizPlayer.classList.add('hidden');
            quizCreator.classList.add('hidden');
            resultsPage.classList.add('hidden');
            liveDashboard.classList.add('hidden');
            homePage.classList.remove('hidden');
            
            // Reload quizzes in case new ones were added
            loadQuizzes();
        }
        
        function shareResults() {
            const shareText = `I scored ${quizResults.score}/${quizResults.total} (${quizResults.percentage}%) on "${currentQuiz.title}"! Can you beat my score?`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'My Quiz Results',
                    text: shareText,
                    url: window.location.href
                }).catch(err => {
                    console.log('Error sharing:', err);
                    copyToClipboard(shareText);
                });
            } else {
                copyToClipboard(shareText);
            }
        }
        
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            alert('Results copied to clipboard!');
        }
        
        // Live Quiz Functions
        function startLiveQuiz(quizId) {
            db.ref(`quizzes/${quizId}`).once('value')
                .then(snapshot => {
                    currentQuiz = {
                        id: quizId,
                        ...snapshot.val()
                    };
                    
                    // Set quiz to live mode
                    db.ref(`quizzes/${quizId}/isLive`).set(true);
                    
                    // Generate a random code for the live quiz
                    const liveCode = `ZQ-${Math.random().toString(36).substr(2, 4).toUpperCase()}`;
                    
                    // Initialize live state
                    liveParticipants = [];
                    currentQuestionIndex = 0;
                    
                    // Show live dashboard
                    showLiveDashboard(liveCode);
                    
                    // Load first question
                    loadLiveQuestion();
                    
                    // Set up real-time listeners
                    setupLiveListeners(quizId, liveCode);
                })
                .catch(error => {
                    console.error("Error starting live quiz:", error);
                    alert('Failed to start live quiz. Please try again.');
                });
        }
        
        function showLiveDashboard(liveCode) {
            homePage.classList.add('hidden');
            quizCreator.classList.add('hidden');
            quizPlayer.classList.add('hidden');
            resultsPage.classList.add('hidden');
            liveDashboard.classList.remove('hidden');
            
            // Set up UI for live quiz
            document.querySelector('.live-quiz-code').textContent = liveCode;
            document.querySelector('.live-quiz-title').textContent = currentQuiz.title;
        }
        
        function loadLiveQuestion() {
            if (currentQuestionIndex < currentQuiz.questions.length) {
                const question = currentQuiz.questions[currentQuestionIndex];
                document.getElementById('currentQuestionDisplay').innerHTML = `
                    <h3>Question ${currentQuestionIndex + 1} of ${currentQuiz.questions.length}</h3>
                    <p>${question.question}</p>
                    ${question.image ? `<img src="${question.image}" alt="Question Image" style="max-width: 100%; height: auto;">` : ''}
                    <ol>
                        ${question.options.map(opt => `<li>${opt}</li>`).join('')}
                    </ol>
                    <p><strong>Correct answer:</strong> ${question.options[question.answer]}</p>
                `;
            } else {
                // Quiz is over
                document.getElementById('currentQuestionDisplay').innerHTML = `
                    <h3>Quiz Completed!</h3>
                    <p>All questions have been answered. Here are the final results:</p>
                `;
            }
        }
        
        function setupLiveListeners(quizId, liveCode) {
            // Listen for new participants
            db.ref(`liveQuizzes/${liveCode}/participants`).on('value', snapshot => {
                const participants = snapshot.val() || {};
                liveParticipants = Object.keys(participants);
                
                // Update participant list
                participantList.innerHTML = '';
                
                Object.entries(participants).forEach(([userId, participant]) => {
                    const li = document.createElement('li');
                    li.className = 'participant-item fade-in';
                    li.innerHTML = `
                        <div class="participant-info">
                            <div class="participant-avatar">${participant.name.charAt(0)}</div>
                            <span>${participant.name}</span>
                        </div>
                        <div class="participant-status ${participant.active ? '' : 'offline'}"></div>
                    `;
                    participantList.appendChild(li);
                });
            });
            
            // Listen for answers
            db.ref(`liveQuizzes/${liveCode}/answers`).on('value', snapshot => {
                const answers = snapshot.val() || {};
                
                // Calculate answer distribution for current question
                if (currentQuestionIndex < currentQuiz.questions.length) {
                    const question = currentQuiz.questions[currentQuestionIndex];
                    const optionCounts = new Array(question.options.length).fill(0);
                    let totalAnswers = 0;
                    
                    Object.values(answers).forEach(answer => {
                        if (answer.questionIndex === currentQuestionIndex) {
                            optionCounts[answer.answer]++;
                            totalAnswers++;
                        }
                    });
                    
                    // Update answer distribution display
                    const answerDistribution = document.querySelector('.answer-distribution');
                    answerDistribution.innerHTML = `
                        <h3>Answer Distribution (${totalAnswers} participants answered)</h3>
                        ${question.options.map((opt, index) => {
                            const percentage = totalAnswers > 0 ? Math.round((optionCounts[index] / totalAnswers) * 100) : 0;
                            return `
                                <div class="distribution-option">
                                    <span>${String.fromCharCode(65 + index)}. ${opt}</span>
                                    <span>${percentage}% (${optionCounts[index]})</span>
                                </div>
                                <div class="distribution-bar">
                                    <div class="distribution-fill" style="width: ${percentage}%"></div>
                                </div>
                            `;
                        }).join('')}
                    `;
                }
            });
            
            // Set up control buttons
            document.querySelector('.start-btn').addEventListener('click', () => {
                // Move to first question
                currentQuestionIndex = 0;
                loadLiveQuestion();
                
                // Disable start button, enable next button
                document.querySelector('.start-btn').disabled = true;
                document.querySelector('.next-btn').disabled = false;
            });
            
            document.querySelector('.next-btn').addEventListener('click', () => {
                // Move to next question
                currentQuestionIndex++;
                loadLiveQuestion();
                
                // Disable next button if we've reached the end
                if (currentQuestionIndex >= currentQuiz.questions.length - 1) {
                    document.querySelector('.next-btn').disabled = true;
                }
            });
            
            document.querySelector('.end-btn').addEventListener('click', () => {
                // End the live quiz
                if (confirm('Are you sure you want to end this live quiz?')) {
                    db.ref(`quizzes/${quizId}/isLive`).set(false);
                    db.ref(`liveQuizzes/${liveCode}`).remove();
                    showHomePage();
                }
            });
        }
        
        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
